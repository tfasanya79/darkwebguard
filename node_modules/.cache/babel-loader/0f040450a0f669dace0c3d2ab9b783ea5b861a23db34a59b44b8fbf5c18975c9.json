{"ast":null,"code":"import React,{useEffect,useState}from'react';import{getProfile}from'../services/api.ts';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminView=_ref=>{let{token}=_ref;const[profile,setProfile]=useState(null);const[users,setUsers]=useState([]);const[alerts,setAlerts]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchData=async()=>{setLoading(true);try{const profileRes=await getProfile(token);setProfile(profileRes.data);if(profileRes.data.is_admin){const usersRes=await fetch('/api/admin/users',{headers:{Authorization:\"Bearer \".concat(token)}});const alertsRes=await fetch('/api/admin/alerts',{headers:{Authorization:\"Bearer \".concat(token)}});setUsers(await usersRes.json());setAlerts(await alertsRes.json());}}catch(_unused){}setLoading(false);};fetchData();},[token]);if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"p-8\",children:\"Loading admin view...\"});if(!(profile!==null&&profile!==void 0&&profile.is_admin))return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 max-w-3xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4\",children:\"Admin Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:\"All Users\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc ml-6\",children:users.map(u=>/*#__PURE__*/_jsxs(\"li\",{children:[u.email,\" (\",u.subscription_status,\")\"]},u.id))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:\"All Alerts\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc ml-6\",children:alerts.map(a=>/*#__PURE__*/_jsxs(\"li\",{children:[\"[\",a.brand,\"] \",a.message,\" (Source: \",a.source,\", Risk: \",a.risk_score,\")\"]},a.id))})]})]});};export default AdminView;","map":{"version":3,"names":["React","useEffect","useState","getProfile","jsx","_jsx","jsxs","_jsxs","AdminView","_ref","token","profile","setProfile","users","setUsers","alerts","setAlerts","loading","setLoading","fetchData","profileRes","data","is_admin","usersRes","fetch","headers","Authorization","concat","alertsRes","json","_unused","className","children","map","u","email","subscription_status","id","a","brand","message","source","risk_score"],"sources":["/home/soc_kungen/darkwebguard/frontend/src/pages/AdminView.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { getProfile } from '../services/api.ts';\n\nconst AdminView: React.FC<{ token: string }> = ({ token }) => {\n  const [profile, setProfile] = useState<any>(null);\n  const [users, setUsers] = useState<any[]>([]);\n  const [alerts, setAlerts] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      setLoading(true);\n      try {\n        const profileRes = await getProfile(token);\n        setProfile(profileRes.data);\n        if (profileRes.data.is_admin) {\n          const usersRes = await fetch('/api/admin/users', { headers: { Authorization: `Bearer ${token}` } });\n          const alertsRes = await fetch('/api/admin/alerts', { headers: { Authorization: `Bearer ${token}` } });\n          setUsers(await usersRes.json());\n          setAlerts(await alertsRes.json());\n        }\n      } catch {}\n      setLoading(false);\n    };\n    fetchData();\n  }, [token]);\n\n  if (loading) return <div className=\"p-8\">Loading admin view...</div>;\n  if (!profile?.is_admin) return null;\n\n  return (\n    <div className=\"p-8 max-w-3xl mx-auto\">\n      <h2 className=\"text-2xl font-bold mb-4\">Admin Dashboard</h2>\n      <div className=\"mb-6\">\n        <h3 className=\"text-xl font-semibold mb-2\">All Users</h3>\n        <ul className=\"list-disc ml-6\">\n          {users.map(u => (\n            <li key={u.id}>{u.email} ({u.subscription_status})</li>\n          ))}\n        </ul>\n      </div>\n      <div>\n        <h3 className=\"text-xl font-semibold mb-2\">All Alerts</h3>\n        <ul className=\"list-disc ml-6\">\n          {alerts.map(a => (\n            <li key={a.id}>[{a.brand}] {a.message} (Source: {a.source}, Risk: {a.risk_score})</li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminView;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}